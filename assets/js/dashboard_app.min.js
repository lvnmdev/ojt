var job_ids=[];$(function(){var t,e;$.ajax({type:"ajax",method:"get",url:"show_bio",async:!0,dataType:"json",success:function(e){var a;console.log(e),e.success&&(t=e.data.sex,$("#user_fullname").val(e.data.fname+" "+e.data.mname+" "+e.data.lname),$("#user_sex").val(e.data.sex),$("#user_birthdate").val(e.data.birthdate),$("#user_nationality").val(e.data.nationality),$("#user_religion").val(e.data.religion),$("#user_home_address").val(e.data.haddress),$("#user_current_address").val(e.data.caddress),$("#mother_fullname").val(e.data.momfname),$("#mother_birthdate").val(e.data.mombday),$("#mother_occupation").val(e.data.momwork),$("#father_fullname").val(e.data.dadfname),$("#father_birthdate").val(e.data.dadbday),$("#father_occupation").val(e.data.dadwork),e.pic&&($("#prof_pic").attr("src","../../ojt/"+e.pic.photo_path),$("#prof_pic1").attr("src","../../ojt/"+e.pic.photo_path)),$("#user_profile_name").html(e.data.fname+" "+e.data.mname+" "+e.data.lname),a=t,console.log(a),$.ajax({type:"ajax",method:"get",url:"show_available_jobs",async:!1,dataType:"json",success:function(t){console.log(t.data);var e,s="";if(t.data){for(e=0;e<t.data.length;e++)a!=t.data[e].pref_sex&&"Either"!=t.data[e].pref_sex||jQuery.inArray(t.data[e].job_id,job_ids)<0&&(s+="<tr><td>"+t.data[e].comp_name+"</td><td>"+t.data[e].position+"</td><td>"+t.data[e].no_applicants+"</td><td>"+t.data[e].pref_sex+"</td><td>"+t.data[e].pref_civstat+"</td><td>"+t.data[e].pref_educ+"</td><td>"+t.data[e].requirements+"</td><td>"+t.data[e].date_posted+'</td><td><button class="btn btn-success apply" value="'+t.data[e].job_id+'">Apply </button></td></tr>');$("#show_jobs").html(s)}},error:function(){alert("Error")}}))},error:function(){alert("Error")}}),$.ajax({type:"ajax",method:"get",url:"show_resume",async:!1,dataType:"json",success:function(t){console.log(t),l=t,t.success||($("#ze_question").modal("show"),$(".btn-info").attr("disabled","disabled"),$("ul.side-navbar").children().click(function(t){t.preventDefault()}));var e,a="",s="",i="",o="",d="";if(t.seminars){for(e=0;e<t.seminars.length;e++)o+='<ul class="resume-list"><li>'+t.seminars[e].seminar+"</li><li>"+t.seminars[e].seminar_date+"</li><li>"+t.seminars[e].conductedby+"</li></ul>";$("#resume_seminar").html(o)}else $(".btn-info").attr("disabled","disabled");if(t.accomplishment){for(e=0;e<t.accomplishment.length;e++)i+='<ul class="resume-list"><li>'+t.accomplishment[e].accomplishment+"</li><li>"+t.accomplishment[e].affiliation+"</li></ul>";$("#resume_accomplishments").html(i)}else $(".btn-info").attr("disabled","disabled");if(t.skills){for(e=0;e<t.skills.length;e++)a+='<ul class="resume-list"><li>'+t.skills[e].skill+"</li></ul>";$("#resume_skills").html(a)}else $(".btn-info").attr("disabled","disabled");if(t.workxp){for(e=0;e<t.workxp.length;e++)s+='<ul class="resume-list"><li>'+t.workxp[e].position+"</li><li>"+t.workxp[e].company+"</li><li>"+t.workxp[e].date_start+"</li><li>"+t.workxp[e].date_end+"</li></ul>";$("#resume_xp").html(s)}else $(".btn-info").attr("disabled","disabled");if(t.education){for(e=0;e<t.education.length;e++)d+='<ul class="resume-list"><li>'+t.education[e].level+"</li><li>"+t.education[e].school+"</li><li>"+t.education[e].start+"</li><li>"+t.education[e].graduated+"</li></ul>";$("#resume_education").html(d)}else $(".btn-info").attr("disabled","disabled")},error:function(){alert("Error")}}),e=[],$.ajax({type:"ajax",method:"get",url:"show_ongoing_applications",async:!1,dataType:"json",success:function(t){console.log(t.data);var a,s="";if(t.data){for(a=0;a<t.data.length;a++)e.push(t.data[a].job_id),s+="<tr><td>"+t.data[a].comp_name+"</td><td>"+t.data[a].comp_hr+"</td><td>"+t.data[a].position+"</td><td>"+t.data[a].requirements+"</td><td>"+t.data[a].date_posted+"</td><td>"+t.data[a].date_applied+"</td>","1"==t.data[a].app_status?s+='<td><button class="btn btn-danger cancel" value="'+t.data[a].pending_id+'"><i class="fa fa-times"></i> Cancel</button></td></tr>':"0"==t.data[a].app_status?s+='<td><button class="btn btn-primary cancel" value="'+t.data[a].pending_id+'"><i class="fa fa-times"></i> Reapply</button></td></tr>':s+="<td>Denied</td></tr>";$("#show_ongoing_application").html(s)}},error:function(){alert("Error")}}),job_ids=e,console.log(job_ids),$.ajax({type:"ajax",method:"get",url:"count_dashboard",async:!1,dataType:"json",success:function(t){console.log(t),null!=t.data?$("#applications_count").html(t.data.pending_applicant):$("#applications_count").html(0),null!=t.data1?$("#jobs_count").html(t.data1.jobs_posted):$("#jobs_count").html(0)},error:function(){alert("Error")}});$(".btn-default").attr("disabled","disabled"),$("#image").click(function(){$(".btn-default").removeAttr("disabled"),setInterval(function(){$("#image").val().length<1?$(".btn-default").attr("disabled","disabled"):$(".btn-default").removeAttr("disabled")},0)}),$("#btnedit_bio").click(function(){$.ajax({type:"ajax",method:"get",url:"show_bio",async:!0,dataType:"json",success:function(t){console.log(t),t.success&&($("#bio_fname").val(t.data.fname),$("#bio_mname").val(t.data.mname),$("#bio_lname").val(t.data.lname),$("#bio_nationality").val(t.data.nationality),$("#bio_religion").val(t.data.religion),$("#bio_h").val(t.data.haddress),$("#bio_c").val(t.data.caddress),$("#bio_bday").val(t.data.birthdate),$("#bio_momfname").val(t.data.momfname),$("#bio_mombday").val(t.data.mombday),$("#bio_momwork").val(t.data.momwork),$("#bio_dadfname").val(t.data.dadfname),$("#bio_dadbday").val(t.data.dadbday),$("#bio_dadwork").val(t.data.dadwork))},error:function(){alert("Error")}}),$("#edit_bio").modal("show")}),$("#form_bio").submit(function(){var t=$("#form_bio").serialize();return console.log(t),$.ajax({type:"ajax",method:"post",url:"edit_bio",data:t,async:!1,dataType:"json",success:function(t){console.log(t),"insert"==t.operation?alert("data inserted"):"update"==t.operation&&alert("data updated"),window.location.href="dashboard"},error:function(){alert("Error")}}),!1}),$("#btnsubmit_resume").attr("disabled","disabled");var a,s,l,o='<div class="form-group"><input id="data_input" style="display:none;" name="data_input" class="form-control"><label id="super_input" class="label-control col-md-3" style="padding: 6px 12px;"></label><div class="col-md-8"><input id="input" type="text" name="" class="form-control" ></div></div><div class="form-group" id="hide_form1"><label id="super_input1" class="label-control col-md-3" style="padding: 6px 12px;"></label><div class="col-md-8"><input id="input1" name="" class="form-control" ></div></div><div class="form-group" id="hide_form2"><label id="super_input2" class="label-control col-md-3" style="padding: 6px 12px;"></label><div class="col-md-8"><input id="input2" name="" class="form-control" ></div></div><div class="form-group" id="hide_form3"><label id="super_input3" class="label-control col-md-3" style="padding: 6px 12px;"></label><div class="col-md-8"><input id="input3" name="" class="form-control" ></div></div>';$("#addqual").click(function(){$("#edit_form_resume").html("");var t=0;$("#edit_resume").modal("show"),$(".modal-title").text("Add Qualifications/Skills"),$("#form_content").html(o),$("#super_input").text("Add Skill"),$("#input").attr("name","skill"),$("#hide_form1").css({display:"none"}),$("#hide_form2").css({display:"none"}),$("#hide_form3").css({display:"none"}),$("#data_input").val("skill"),$("#input").keyup(function(){var t=$("#input").val();t.length>0?1==/^[a-zA-Z0-9- ]*$/.test(t)&&$("#btnsubmit_resume").removeAttr("disabled"):$("#btnsubmit_resume").attr("disabled","disabled")}),$.ajax({type:"ajax",method:"get",url:"show_resume",async:!0,dataType:"json",success:function(e){if(e.skills){var a="";for(t=0;t<e.skills.length;t++)a+='<div class="col-xs-11 col-sm-11 col-md-11"><ul class="resume-list"><li>'+e.skills[t].skill+'</li></div></ul><div class="col-xs-1 col-sm-1 col-md-1"><button class="resume-delete skill-delete" id="'+t+'" value="'+e.skills[t].skill_id+'"><i class="fa fa-times"></i></button></div>';$("#edit_form_resume").html(a)}},error:function(t){}})}),$("#addwork").click(function(){$("#edit_form_resume").html(""),$("#edit_resume").modal("show"),$(".modal-title").text("Add Working Experience"),$("#form_content").html(o),$("#super_input").text("Position"),$("#super_input1").text("Company"),$("#super_input2").text("Date Started"),$("#super_input3").text("Date Ended"),$("#input1").attr("type","text"),$("#input2").attr("type","date"),$("#input3").attr("type","date"),$("#input").attr("name","position"),$("#input1").attr("name","company"),$("#input2").attr("name","date_start"),$("#input3").attr("name","date_end"),$("#input2").attr("required","required"),$("#input3").attr("required","required"),$("#data_input").val("work"),$("#input").keyup(function(){(a=$("#input").val()).length>0&&s.length>0?$("#btnsubmit_resume").removeAttr("disabled"):$("#btnsubmit_resume").attr("disabled","disabled")}),$("#input1").keyup(function(){s=$("#input1").val(),a.length>0&&s.length>0?(0==/^[a-zA-Z0-9- ]*$/.test(a)&&$("#btn_submit_resume").attr("disabled","disabled"),$("#btnsubmit_resume").removeAttr("disabled")):$("#btnsubmit_resume").attr("disabled","disabled")}),$.ajax({type:"ajax",method:"get",url:"show_resume",async:!0,dataType:"json",success:function(t){var e="";if(t.workxp){for(i=0;i<t.workxp.length;i++)e+='<div class="col-xs-11 col-sm-11 col-md-11"><ul class="resume-list"><li>'+t.workxp[i].position+"</li><li>"+t.workxp[i].company+"</li><li>"+t.workxp[i].date_start+"</li><li>"+t.workxp[i].date_end+'</li></div></ul><div class="col-xs-1 col-sm-1 col-md-1"><button class="resume-delete work-delete" id="'+i+'" value="'+t.workxp[i].work_id+'"><i class="fa fa-times"></i></button></div>';$("#edit_form_resume").html(e)}},error:function(t){}})}),$("#addacco").click(function(){$("#edit_form_resume").html(""),$("#edit_resume").modal("show"),$(".modal-title").text("Add Accomplishments"),$("#form_content").html(o),$("#super_input").text("Accomplishment"),$("#super_input1").text("Affiliation"),$("#input1").attr("type","text"),$("#input").attr("name","accomplishment"),$("#input1").attr("name","affiliation"),$("#data_input").val("accomplishment"),$("#hide_form2").css({display:"none"}),$("#hide_form3").css({display:"none"}),$("#input").keyup(function(){(a=$("#input").val()).length>0&&s.length>0?$("#btnsubmit_resume").removeAttr("disabled"):$("#btnsubmit_resume").attr("disabled","disabled")}),$("#input1").keyup(function(){s=$("#input1").val(),a.length>0&&s.length>0?$("#btnsubmit_resume").removeAttr("disabled"):$("#btnsubmit_resume").attr("disabled","disabled")}),$.ajax({type:"ajax",method:"get",url:"show_resume",async:!0,dataType:"json",success:function(t){var e="";if(t.accomplishment){for(i=0;i<t.accomplishment.length;i++)e+='<div class="col-xs-11 col-sm-11 col-md-11"><ul class="resume-list"><li>'+t.accomplishment[i].accomplishment+"</li><li>"+t.accomplishment[i].affiliation+'</li></div></ul><div class="col-xs-1 col-sm-1 col-md-1"><button class="resume-delete acc-delete" id="'+i+'" value="'+t.accomplishment[i].accomplishment_id+'"><i class="fa fa-times"></i></button></div>';$("#edit_form_resume").html(e)}},error:function(t){}})}),$("#addeduc").click(function(){$("#edit_form_resume").html(""),$("#edit_resume").modal("show"),$(".modal-title").text("Add Educational Background"),$("#form_content").html(o),$("#super_input").text("Level"),$("#super_input1").text("Name of School"),$("#super_input2").text("Date Started"),$("#super_input3").text("Date Graduated"),$("#input1").attr("type","text"),$("#input2").attr("type","date"),$("#input3").attr("type","date"),$("#input2").attr("required","required"),$("#input3").attr("required","required"),$("#input").attr("name","level"),$("#input1").attr("name","school"),$("#input2").attr("name","start"),$("#input3").attr("name","graduate"),$("#data_input").val("education"),$("#input").keyup(function(){(a=$("#input").val()).length>0&&s.length>0?$("#btnsubmit_resume").removeAttr("disabled"):$("#btnsubmit_resume").attr("disabled","disabled")}),$("#input1").keyup(function(){s=$("#input1").val(),a.length>0&&s.length>0?$("#btnsubmit_resume").removeAttr("disabled"):$("#btnsubmit_resume").attr("disabled","disabled")}),$.ajax({type:"ajax",method:"get",url:"show_resume",async:!0,dataType:"json",success:function(t){var e="";if(t.education){for(i=0;i<t.education.length;i++)e+='<div class="col-xs-11 col-sm-11 col-md-11"><ul class="resume-list"><li>'+t.education[i].level+"</li><li>"+t.education[i].school+"</li><li>"+t.education[i].start+"</li><li>"+t.education[i].graduated+'</li></div></ul><div class="col-xs-1 col-sm-1 col-md-1"><button class="resume-delete educ-delete" id="'+i+'" value="'+t.education[i].educ_id+'"><i class="fa fa-times"></i></button></div>';$("#edit_form_resume").html(e)}},error:function(t){}})}),$("#addsemi").click(function(){$("#edit_form_resume").html(""),$("#edit_resume").modal("show"),$(".modal-title").text("Add Seminars Attended"),$("#form_content").html(o),$("#super_input").text("Name of Seminar"),$("#super_input1").text("Date"),$("#super_input2").text("Conducted by"),$("#input1").attr("type","date"),$("#input2").attr("type","text"),$("#input").attr("name","seminar"),$("#input1").attr("name","seminar_date"),$("#input1").attr("required","required"),$("#input2").attr("name","conductedby"),$("#data_input").val("seminar"),$("#hide_form3").css({display:"none"}),$("#input").keyup(function(){(a=$("#input").val()).length>0&&s.length>0?$("#btnsubmit_resume").removeAttr("disabled"):$("#btnsubmit_resume").attr("disabled","disabled")}),$("#input2").keyup(function(){s=$("#input2").val(),a.length>0&&s.length>0?$("#btnsubmit_resume").removeAttr("disabled"):$("#btnsubmit_resume").attr("disabled","disabled")}),$.ajax({type:"ajax",method:"get",url:"show_resume",async:!0,dataType:"json",success:function(t){var e="";if(t.seminars){for(i=0;i<t.seminars.length;i++)e+='<div class="col-xs-11 col-sm-11 col-md-11"><ul class="resume-list"><li>'+t.seminars[i].seminar+"</li><li>"+t.seminars[i].seminar_date+"</li><li>"+t.seminars[i].conductedby+'</li></div></ul><div class="col-xs-1 col-sm-1 col-md-1"><button class="resume-delete semi-delete" id="'+i+'" value="'+t.seminars[i].seminar_id+'"><i class="fa fa-times"></i></button></div>';$("#edit_form_resume").html(e)}},error:function(t){}})}),$("#form_resume").submit(function(){$("#btnsubmit_resume").attr("disabled","disabled");var t=$("#form_resume").serialize();console.log(t),$.ajax({type:"ajax",method:"post",url:"edit_resume",data:t,async:!1,dataType:"json",success:function(t){console.log(t),t.success&&(alert("inserted"),location.reload())},error:function(){alert("Error")}})}),$(".btn-info").click(function(t){l.success&&l.seminars&&l.accomplishment&&l.skills&&l.workxp&&l.education||t.preventDefault(),console.log(l)}),$(document).on("click",".cancel",function(t){$("#cancel_application").modal("show"),$(".modal-title").text("Cancel Application?"),job_id_app=$(t.currentTarget).val(),console.log(job_id_app)}),$(document).on("click",".apply",function(t){$("#apply_job").modal("show"),$(".modal-title").text("Confirm Apply"),job_id_app=$(t.currentTarget).val(),$.ajax({type:"ajax",method:"get",url:"show_available_jobs",async:!1,dataType:"json",success:function(t){console.log(t.data);var e,a="";if(t.data){for(e=0;e<t.data.length;e++)t.data[e].job_id==job_id_app&&(a+='<div class="row"><div class="col-xs-4 col-sm-4 col-md-4"><strong>Company Name</strong></div><div class="col-xs-8 col-sm-8 col-md-8">:&nbsp'+t.data[e].comp_name+'</div></div><div class="row"><div class="col-xs-4 col-sm-4 col-md-4"><strong>Position</strong></div><div class="col-xs-8 col-sm-8 col-md-8">:&nbsp'+t.data[e].position+'</div></div><div class="row"><div class="col-xs-4 col-sm-4 col-md-4"><strong>Preferred Sex</strong></div><div class="col-xs-8 col-sm-8 col-md-8">:&nbsp'+t.data[e].pref_sex+'</div></div><div class="row"><div class="col-xs-4 col-sm-4 col-md-4"><strong>Preferred Civil Status</strong></div><div class="col-xs-8 col-sm-8 col-md-8">:&nbsp'+t.data[e].pref_civstat+'</div></div><div class="row"><div class="col-xs-4 col-sm-4 col-md-4"><strong>Preferred Education Attained</strong></div><div class="col-xs-8 col-sm-8 col-md-8">:&nbsp'+t.data[e].pref_educ+'</div></div><div class="row"><div class="col-xs-4 col-sm-4 col-md-4"><strong>Requirements</strong></div><div class="col-xs-8 col-sm-8 col-md-8">:&nbsp'+t.data[e].requirements+'</div></div><div class="row"><div class="col-xs-4 col-sm-4 col-md-4"><strong>Date Posted</strong></div><div class="col-xs-8 col-sm-8 col-md-8">:&nbsp'+t.data[e].date_posted+"</div></div>");$("#job_desc").html(a)}},error:function(){alert("Error")}})}),$("#confirm_app").click(function(){var t=job_id_app;console.log(t),$.ajax({type:"ajax",method:"post",url:"apply_job",data:{id:t},async:!1,dataType:"json",success:function(t){console.log(t),t.success&&(alert("inserted"),location.reload())},error:function(){alert("Error")}})}),$("#confirm_cancel").click(function(){var t=job_id_app;console.log(t),$.ajax({type:"ajax",method:"post",url:"cancel_job",data:{id:t},async:!1,dataType:"json",success:function(t){console.log(t),t.success&&(alert("JOB APPLICATION ABORTED"),location.reload())},error:function(){alert("Error")}})}),$(document).on("click",".skill-delete",function(t){var e=$(t.currentTarget).val();console.log(e),$.ajax({type:"ajax",method:"post",url:"delete_resume",data:{id:e,field:"skill"},async:!1,dataType:"json",success:function(t){console.log(t),t&&(alert("deleted"),location.reload())},error:function(){alert("Error")}})}),$(document).on("click",".educ-delete",function(t){var e=$(t.currentTarget).val();console.log(e),$.ajax({type:"ajax",method:"post",url:"delete_resume",data:{id:e,field:"education"},async:!1,dataType:"json",success:function(t){console.log(t),t.success&&(alert("deleted"),location.reload())},error:function(){alert("Error")}})}),$(document).on("click",".work-delete",function(t){var e=$(t.currentTarget).val();console.log(e),$.ajax({type:"ajax",method:"post",url:"delete_resume",data:{id:e,field:"work"},async:!1,dataType:"json",success:function(t){console.log(t),t.success&&(alert("deleted"),location.reload())},error:function(){alert("Error")}})}),$(document).on("click",".semi-delete",function(t){var e=$(t.currentTarget).val();console.log(e),$.ajax({type:"ajax",method:"post",url:"delete_resume",data:{id:e,field:"seminar"},async:!1,dataType:"json",success:function(t){console.log(t),t.success&&(alert("deleted"),location.reload())},error:function(){alert("Error")}})}),$(document).on("click",".acc-delete",function(t){var e=$(t.currentTarget).val();console.log(e),$.ajax({type:"ajax",method:"post",url:"delete_resume",data:{id:e,field:"accomplishment"},async:!1,dataType:"json",success:function(t){console.log(t),t.success&&(alert("deleted"),location.reload())},error:function(){alert("Error")}})}),$("#change_user").attr("disabled","disabled"),$("#change_pass").attr("disabled","disabled"),$("#new_user").keyup(function(){var t=$("#new_user").val();$("#illegal_user").css({display:"none"}),t.length>0?0==/^[a-zA-Z0-9- ]*$/.test(t)?($("#change_user").attr("disabled","disabled"),$("#illegal_user").removeAttr("style"),$("#illegal_user").html("Your username contains illegal characters.")):$("#change_user").removeAttr("disabled"):$("#change_user").attr("disabled","disabled")}),$("#form_change_user").submit(function(){var t=$("#form_change_user").serializeArray();console.log(t),$.ajax({type:"ajax",url:"change_username",method:"POST",data:t,async:!1,dataType:"json",success:function(t){console.log(t),t.success&&($("#success_user").removeAttr("style"),$("#success_user").html("Username Updated"))},error:function(t,e,a){alert(e+" "+a)}})}),$("#prof_pic1").load(function(){setInterval(function(){$("#illegal_user1").css({display:"none"});var t=$("#pass_new").val(),e=$("#pass_con").val();t.length>0&&e.length>0?($("#change_pass").removeAttr("disabled"),e!=t&&($("#change_pass").attr("disabled","disabled"),$("#illegal_user1").removeAttr("style"),$("#illegal_user1").html("Passwords do not match"))):$("#change_pass").attr("disabled","disabled")},0)}),$("#form_change_password").submit(function(){var t=$("#form_change_password").serializeArray();console.log(t),$.ajax({type:"ajax",url:"change_password",method:"POST",data:t,async:!1,dataType:"json",success:function(t){console.log(t),t.success&&($("#success_user1").removeAttr("style"),$("#success_user1").html("Password Updated"))},error:function(t,e,a){alert(e+" "+a)}})})});